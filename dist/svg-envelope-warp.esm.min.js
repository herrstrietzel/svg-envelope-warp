const{abs:t,acos:e,asin:n,atan:i,atan2:r,ceil:o,cos:h,exp:l,floor:a,log:s,hypot:u,max:p,min:x,pow:y,random:c,round:w,sin:g,sqrt:f,tan:d,PI:m}=Math;function M(t=[],e=[]){let n=t.slice(2),i=0,r=0;for(let t=0;t<e.length;t++)i+=n[t]*e[t].x,r+=n[t]*e[t].y;return[i,r,...n]}function B(t){let e=[],n=Array.isArray(t),i=n&&2===t[0].length,r=n&&"object"==typeof t[0]&&!i;if(!r&&"object"==typeof t&&[...t].length>1&&(r="SVGPoint"===(t=[...t])[0].constructor.name),r)return t;if(i)return e=t.map(t=>({x:t[0],y:t[1]})),e;let o="string"==typeof t;if(!o)return console.warn("Couldn't parse point input",typeof t,t),e;t=o?t.trim().replace(/[\n|\r|\t]/g,""):t;let h=o&&(t.startsWith("m")||t.startsWith("M")),l=t.includes("[")&&t.includes("{")&&t.includes("x")&&t.includes("y");if(h)return e=function(t){let e=[],n=!/[csqta]/gi.test(t),i=!!/[vh]/gi.test(t),r=!(!/[l]/gi.test(t)&&!t.startsWith("m"));const o="http://www.w3.org/2000/svg";if(t=t.replaceAll("-"," -"),!n||r||i){let i=document.createElementNS(o,"svg"),r=document.createElementNS(o,"path");r.setAttribute("d",t),i.append(r);let h=new Warp(i),l=n?1/0:3;h.interpolate(l),h.paths.forEach(t=>{let n=t.pathData.map(t=>({x:t.x,y:t.y}));e.push(...n)})}else{let n=(t=t.replace(/[M|L]/g," ")).replaceAll(","," ").split(" ").filter(Boolean).map(Number);for(let t=1,i=n.length;t<i;t+=2)e.push({x:n[t-1],y:n[t]})}return v(e)}(t),e;if(l)try{e=JSON.parse(t)}catch{console.warn("no valid point json")}else e=t.replaceAll(","," ").split(" ").filter(Boolean).map(Number),e=function(t){let e=[];for(let n=1,i=t.length;n<i;n+=2)e.push({x:t[n-1],y:t[n]});return e}(e);return e=v(e),e}function b(t){return t.map(t=>[t.x,t.y].join(" ")).join(" ")}function v(t){let e=[];return t.forEach((n,i)=>{let r=i>0?i-1:t.length-1,o=t[r];n.x===o.x&&o.y===n.y&&e.push(r)}),e.forEach(e=>{t.splice(e,1)}),t}function A(t,e=100,n=100,i=!1,r=!1,o={x:0,y:0,width:0,height:0},h=0){if(!t||t.length<3)return t;let l=JSON.parse(JSON.stringify(t));i&&o.width&&(e=o.width,n=o.height);let a=N(t),s=e/a.width,u=n/a.height,p=a.x,x=a.y;if(i){let t=Math.max(s,u);s=u=t}let y=function(t,e=!0){let n=0;for(let e=0,i=t.length;i&&e<i;e++){let r=t[e===i-1?0:e+1];n+=t[e].x*r.y*.5-r.x*t[e].y*.5}return e?Math.abs(n):n}(l,!1);y>0||(l=l.reverse()),l=function(t,e){if(!t||0===t.length)return t;e||(e=N(t));let n={x:e.left,y:e.top},i=0,r=1/0;for(let e=0;e<t.length;e++){let o=V(t[e],n);o<r&&(r=o,i=e)}return t.slice(i).concat(t.slice(0,i))}(l,a),l=l.map(t=>({x:(t.x-p)*s,y:(t.y-x)*u}));let c=N(l),w=(e-c.width)/2-c.x,g=(n-c.height)/2-c.y;return i&&o.width&&(w+=o.x,g+=o.y),i&&r&&(w-=o.x,g-=o.y,o.x=0,o.y=0),l=l.map(t=>({x:t.x+w,y:t.y+g})),c=N(l),h&&(o.x-=h,o.y-=h,o.width+=2*h,o.height+=2*h),{bb:c,rect:i&&o.width?S(l,o):S(l,c),poly:l}}function S(t,e){if(!t||t.length<4)return[];const n=t.length,i=e.width>=e.height,r=Math.floor(n/4);let o=n-4*r;const h={x:e.x,y:e.y},l={x:e.x+e.width,y:e.y},a={x:e.x+e.width,y:e.y+e.height},s={x:e.x,y:e.y+e.height};let u=r,p=r,x=r,y=r;i?x+=o:p+=o;const c=[],w=(t,e,n)=>{const i=[];for(let r=0;r<n;r++){const o=r/n;i.push({x:t.x+(e.x-t.x)*o,y:t.y+(e.y-t.y)*o})}return i};return c.push(...w(h,l,u)),c.push(...w(l,a,p)),c.push(...w(a,s,x)),c.push(...w(s,h,y)),c.length>n&&(c.length=n),c}function N(t){let e=t.map(t=>t.x),n=t.map(t=>t.y),i=Math.min(...e),r=Math.max(...e),o=Math.min(...n),h=Math.max(...n);return{x:i,left:i,right:r,y:o,top:o,bottom:h,width:r-i,height:h-o}}function V(t,e){return(e.x-t.x)**2+(e.y-t.y)**2}function W(t,e="",n={}){if(!e)return!1;(n={fitToHull:!1,threshold:1e3,autoViewBox:!1,resetHull:!1,viewBox:{x:0,y:0,width:0,height:0},hullPadding:0,...n}).viewBox.width||(n.autoViewBox=!0);let{viewBox:i,fitToHull:r,autoViewBox:o,resetHull:h,threshold:l,hullPadding:a}=n;"string"==typeof i&&(i=i.split(/[,| ]/).filter(Boolean).map(Number)),Array.isArray(i)&&(i={x:i[0],y:i[1],width:i[1],height:i[2]});const s="http://www.w3.org/2000/svg";if("string"===typeof t&&(t.startsWith("M")||t.startsWith("m"))){let e=document.createElementNS(s,"svg"),r=document.createElementNS(s,"path");r.setAttribute("d",t),e.append(r),document.body.append(e),t=e,i.width||(i=t.getBBox(),console.log(i),n.autoViewBox=!0),t.setAttribute("viewBox",[i.x,i.y,i.width,i.height].join(" "))}new Warp(t).envelope(e,n)}Warp.prototype.envelope=function(t="",{fitToHull:e=!1,threshold:n=1e3,autoViewBox:i=!1,hullPadding:r=0,resetHull:o=!1}={}){if(!t)return!1;let h=this.element,l=h.getBBox(),a=h.getAttribute("viewBox");i&&(l.width=2*l.x+l.width,l.height=2*l.y+l.height);let s=a&&!i?h.viewBox.baseVal:l,{x:u,y:p,width:x,height:y}=s;a||(x+=2*u,y+=2*p);let c=[0,0,x,y].map(t=>+t.toFixed(0));i&&h.setAttribute("viewBox",c.join(" "));let w=A(B(t),x,y,e,i,l,r),{rect:g,poly:f}=w,d=g,m=o?g:f;return this.transform(t=>function(t,e=[]){let n=[],i=[],r=[],o={x:t[0],y:t[1]};for(let t=0;t<e.length;t++){let i=(t+1)%e.length,r=e[t],h=e[i],l=Math.sqrt(Math.pow(o.x-r.x,2)+Math.pow(o.y-r.y,2)),a=Math.sqrt(Math.pow(o.x-h.x,2)+Math.pow(o.y-h.y,2)),s=Math.sqrt(Math.pow(r.x-h.x,2)+Math.pow(r.y-h.y,2)),u=2*l*a,p=(Math.pow(l,2)+Math.pow(a,2)-Math.pow(s,2))/u;n[t]=isNaN(p)?0:Math.acos(Math.max(-1,Math.min(p,1)))}for(let t=0;t<e.length;t++){let r=(t>0?t:e.length)-1,h=e[t],l=Math.sqrt(Math.pow(h.x-o.x,2)+Math.pow(h.y-o.y,2));i[t]=(Math.tan(n[r]/2)+Math.tan(n[t]/2))/l}let h=i.reduce(function(t,e){return t+e},0);for(let t=0;t<e.length;t++)r[t]=i[t]/h;return[o.x,o.y,...r]}(t,d)),this.interpolate(n),this.transform(t=>M(t,m)),this.getViewBox=()=>c,this.getRect=()=>g,this.getPoly=()=>m,this.getSVG=()=>(new XMLSerializer).serializeToString(h),this.getPathData=()=>function(t){let e="";return t.querySelectorAll("path").forEach(t=>{e+=t.getAttribute("d")}),e}(h),this},"undefined"!=typeof window&&(window.stringifyToPointAtt=b,window.applyWarp=M,window.warpSVG=W);export{m as PI,t as abs,e as acos,M as applyWarp,n as asin,i as atan,r as atan2,o as ceil,h as cos,l as exp,a as floor,u as hypot,s as log,p as max,x as min,y as pow,c as random,w as round,g as sin,f as sqrt,b as stringifyToPointAtt,d as tan,W as warpSVG};
